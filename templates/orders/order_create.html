{% extends "base.html" %} {% load static %} {% block content %}
<section class="product-details pt-5 bg-light md-mb-4">
   <div class="container pt-5 mb-3">
      <h4 class="text-success-emphasis mb-md-3">Checkout</h4>
      <hr class="md-md-3">
      {% if cart %}
      <div class="row justify-content-center">
         <div class="col-md-6 col-12">
            <div class="card shadow-sm border-0 mb-3">
               <div class="card-body">
                  <p class="card-text small text-muted mb-2">
                     Please fill in your details to complete the order.
                  </p>
                  <form method="POST" action="{% url 'orders:order_create' %}">
                     {% csrf_token %}
                     {% if form.non_field_errors %}
                     <div class="alert alert-danger">
                        {{ form.non_field_errors }}
                     </div>
                     {% endif %}
                     <fieldset>
                        <div class="mb-3">
                           <label for="{{ form.email.id_for_label }}" class="form-label">Email address</label>
                           {{ form.email }}
                           <small id="emailHelp" class="form-text text-muted">
                           We'll never share your email with anyone else.
                           </small>
                           {% for error in form.email.errors %}
                           <div class="text-danger small">{{ error }}</div>
                           {% endfor %}
                        </div>
                        <div class="mb-3">
                           <label for="{{ form.first_name.id_for_label }}" class="form-label">Firstname</label>
                           {{ form.first_name }}
                           {% for error in form.first_name.errors %}
                           <div class="text-danger small">{{ error }}</div>
                           {% endfor %}
                        </div>
                        <div class="mb-3">
                           <label for="{{ form.last_name.id_for_label }}" class="form-label">Lastname</label>
                           {{ form.last_name }}
                           {% for error in form.last_name.errors %}
                           <div class="text-danger small">{{ error }}</div>
                           {% endfor %}
                        </div>
                        <div class="mb-3">
                           <label for="{{ form.address.id_for_label }}" class="form-label">Address</label>
                           {{ form.address }}
                           {% for error in form.address.errors %}
                           <div class="text-danger small">{{ error }}</div>
                           {% endfor %}
                        </div>
                        <div class="mb-3">
                           <label for="{{ form.postal_code.id_for_label }}" class="form-label">Postal Code</label>
                           {{ form.postal_code }}
                           {% for error in form.postal_code.errors %}
                           <div class="text-danger small">{{ error }}</div>
                           {% endfor %}
                        </div>
                        <div class="mb-3">
                           <label for="{{ form.city.id_for_label }}" class="form-label">City</label>
                           {{ form.city }}
                           {% for error in form.city.errors %}
                           <div class="text-danger small">{{ error }}</div>
                           {% endfor %}
                        </div>
                     </fieldset>
                     <h3 class="mt-4 mb-3">Your Cart</h3>
                     <ul class="list-group mb-3">
                        {% for item in cart %}
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                           <div>
                              <strong>{{ item.product.title }}</strong>
                              <div class="small text-muted">
                                 {{ item.dimension }}, {{ item.frame_type }}, {{ item.frame_color }}
                              </div>
                              <span class="badge bg-secondary rounded-pill mt-1 text-light">× {{ item.quantity }}</span>
                           </div>
                           <span class="fw-bold">{{ item.total_price }} €</span>
                        </li>
                        {% endfor %}
                        <li class="list-group-item d-flex justify-content-between align-items-center bg-light">
                           <span class="fw-bold">Total</span>
                           <span class="fw-bold text-success">{{ cart.get_total_price }} €</span>
                        </li>
                     </ul>
                     <div class="text-center">
                        <button type="submit" class="btn btn-dark">Submit</button>
                     </div>
                  </form>
               </div>
            </div>
         </div>
      </div>
      {% else %}
      <div class="text-center py-5">
         <p class="lead">Your cart is empty.</p>
         <a href="{% url 'store' %}" class="btn btn-outline-secondary btn-lg">
         <i class="fa-solid fa-arrow-left me-1"></i> Continue Shopping
         </a>
      </div>
      {% endif %}
   </div>
</section>
{% endblock %}